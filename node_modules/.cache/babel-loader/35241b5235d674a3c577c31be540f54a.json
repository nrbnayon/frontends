{"ast":null,"code":"import _toConsumableArray from\"E:/Project File/Chatters-a-mern-app/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"E:/Project File/Chatters-a-mern-app/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"E:/Project File/Chatters-a-mern-app/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"E:/Project File/Chatters-a-mern-app/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Button}from\"@chakra-ui/button\";import{useDisclosure}from\"@chakra-ui/hooks\";import{Input}from\"@chakra-ui/input\";import{Box,Text}from\"@chakra-ui/layout\";import{Menu,MenuButton,MenuDivider,MenuItem,MenuList}from\"@chakra-ui/menu\";import{Drawer,DrawerBody,DrawerContent,DrawerHeader,DrawerOverlay}from\"@chakra-ui/modal\";import{Tooltip}from\"@chakra-ui/tooltip\";import{BellIcon,ChevronDownIcon}from\"@chakra-ui/icons\";import{Avatar}from\"@chakra-ui/avatar\";import{useHistory}from\"react-router-dom\";import{useState}from\"react\";import axios from\"axios\";import{useToast}from\"@chakra-ui/toast\";import ChatLoading from\"../ChatLoading\";import{Spinner}from\"@chakra-ui/spinner\";import ProfileModal from\"./ProfileModal\";import NotificationBadge from\"react-notification-badge\";import{Effect}from\"react-notification-badge\";import{getSender}from\"../../config/ChatLogics\";import UserListItem from\"../userAvatar/UserListItem\";import{ChatState}from\"../../Context/ChatProvider\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function SideDrawer(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),search=_useState2[0],setSearch=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),searchResult=_useState4[0],setSearchResult=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),loading=_useState6[0],setLoading=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),loadingChat=_useState8[0],setLoadingChat=_useState8[1];var _ChatState=ChatState(),setSelectedChat=_ChatState.setSelectedChat,user=_ChatState.user,notification=_ChatState.notification,setNotification=_ChatState.setNotification,chats=_ChatState.chats,setChats=_ChatState.setChats;var toast=useToast();var _useDisclosure=useDisclosure(),isOpen=_useDisclosure.isOpen,onOpen=_useDisclosure.onOpen,onClose=_useDisclosure.onClose;var history=useHistory();var logoutHandler=function logoutHandler(){localStorage.removeItem(\"userInfo\");history.push(\"/\");};var handleSearch=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var config,_yield$axios$get,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(search){_context.next=3;break;}toast({title:\"Please Enter something in search\",status:\"warning\",duration:5000,isClosable:true,position:\"top-left\"});return _context.abrupt(\"return\");case 3:_context.prev=3;setLoading(true);config={headers:{Authorization:\"Bearer \".concat(user.token)}};_context.next=8;return axios.get(\"/api/user?search=\".concat(search),config);case 8:_yield$axios$get=_context.sent;data=_yield$axios$get.data;setLoading(false);setSearchResult(data);_context.next=17;break;case 14:_context.prev=14;_context.t0=_context[\"catch\"](3);toast({title:\"Error Occured!\",description:\"Failed to Load the Search Results\",status:\"error\",duration:5000,isClosable:true,position:\"bottom-left\"});case 17:case\"end\":return _context.stop();}}},_callee,null,[[3,14]]);}));return function handleSearch(){return _ref.apply(this,arguments);};}();var accessChat=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(userId){var config,_yield$axios$post,data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:console.log(userId);_context2.prev=1;setLoadingChat(true);config={headers:{\"Content-type\":\"application/json\",Authorization:\"Bearer \".concat(user.token)}};_context2.next=6;return axios.post(\"/api/chat\",{userId:userId},config);case 6:_yield$axios$post=_context2.sent;data=_yield$axios$post.data;if(!chats.find(function(c){return c._id===data._id;}))setChats([data].concat(_toConsumableArray(chats)));setSelectedChat(data);setLoadingChat(false);onClose();_context2.next=17;break;case 14:_context2.prev=14;_context2.t0=_context2[\"catch\"](1);toast({title:\"Error fetching the chat\",description:_context2.t0.message,status:\"error\",duration:5000,isClosable:true,position:\"bottom-left\"});case 17:case\"end\":return _context2.stop();}}},_callee2,null,[[1,14]]);}));return function accessChat(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Box,{d:\"flex\",justifyContent:\"space-between\",alignItems:\"center\",bg:\"white\",w:\"100%\",p:\"5px 10px 5px 10px\",borderWidth:\"5px\",children:[/*#__PURE__*/_jsx(Tooltip,{label:\"Search Users to chat\",hasArrow:true,placement:\"bottom-end\",children:/*#__PURE__*/_jsxs(Button,{variant:\"ghost\",onClick:onOpen,children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-search\"}),/*#__PURE__*/_jsx(Text,{d:{base:\"none\",md:\"flex\"},px:4,children:\"Search User\"})]})}),/*#__PURE__*/_jsx(Text,{fontSize:\"2xl\",fontFamily:\"Work sans\",children:\"Chatters\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(Menu,{children:[/*#__PURE__*/_jsxs(MenuButton,{p:1,children:[/*#__PURE__*/_jsx(NotificationBadge,{count:notification.length,effect:Effect.SCALE}),/*#__PURE__*/_jsx(BellIcon,{fontSize:\"2xl\",m:1})]}),/*#__PURE__*/_jsxs(MenuList,{pl:2,children:[!notification.length&&\"No New Messages\",notification.map(function(notif){return/*#__PURE__*/_jsx(MenuItem,{onClick:function onClick(){setSelectedChat(notif.chat);setNotification(notification.filter(function(n){return n!==notif;}));},children:notif.chat.isGroupChat?\"New Message in \".concat(notif.chat.chatName):\"New Message from \".concat(getSender(user,notif.chat.users))},notif._id);})]})]}),/*#__PURE__*/_jsxs(Menu,{children:[/*#__PURE__*/_jsx(MenuButton,{as:Button,bg:\"white\",rightIcon:/*#__PURE__*/_jsx(ChevronDownIcon,{}),children:/*#__PURE__*/_jsx(Avatar,{size:\"sm\",cursor:\"pointer\",name:user.name,src:user.pic})}),/*#__PURE__*/_jsxs(MenuList,{children:[/*#__PURE__*/_jsxs(ProfileModal,{user:user,children:[/*#__PURE__*/_jsx(MenuItem,{children:\"My Profile\"}),\" \"]}),/*#__PURE__*/_jsx(MenuDivider,{}),/*#__PURE__*/_jsx(MenuItem,{onClick:logoutHandler,children:\"Logout\"})]})]})]})]}),/*#__PURE__*/_jsxs(Drawer,{placement:\"left\",onClose:onClose,isOpen:isOpen,children:[/*#__PURE__*/_jsx(DrawerOverlay,{}),/*#__PURE__*/_jsxs(DrawerContent,{children:[/*#__PURE__*/_jsx(DrawerHeader,{borderBottomWidth:\"1px\",children:\"Search Users\"}),/*#__PURE__*/_jsxs(DrawerBody,{children:[/*#__PURE__*/_jsxs(Box,{d:\"flex\",pb:2,children:[/*#__PURE__*/_jsx(Input,{placeholder:\"Search by name or email\",mr:2,value:search,onChange:function onChange(e){return setSearch(e.target.value);}}),/*#__PURE__*/_jsx(Button,{onClick:handleSearch,children:\"Go\"})]}),loading?/*#__PURE__*/_jsx(ChatLoading,{}):searchResult===null||searchResult===void 0?void 0:searchResult.map(function(user){return/*#__PURE__*/_jsx(UserListItem,{user:user,handleFunction:function handleFunction(){return accessChat(user._id);}},user._id);}),loadingChat&&/*#__PURE__*/_jsx(Spinner,{ml:\"auto\",d:\"flex\"})]})]})]})]});}export default SideDrawer;","map":{"version":3,"sources":["E:/Project File/Chatters-a-mern-app/frontend/src/components/miscellaneous/SideDrawer.js"],"names":["Button","useDisclosure","Input","Box","Text","Menu","MenuButton","MenuDivider","MenuItem","MenuList","Drawer","DrawerBody","DrawerContent","DrawerHeader","DrawerOverlay","Tooltip","BellIcon","ChevronDownIcon","Avatar","useHistory","useState","axios","useToast","ChatLoading","Spinner","ProfileModal","NotificationBadge","Effect","getSender","UserListItem","ChatState","SideDrawer","search","setSearch","searchResult","setSearchResult","loading","setLoading","loadingChat","setLoadingChat","setSelectedChat","user","notification","setNotification","chats","setChats","toast","isOpen","onOpen","onClose","history","logoutHandler","localStorage","removeItem","push","handleSearch","title","status","duration","isClosable","position","config","headers","Authorization","token","get","data","description","accessChat","userId","console","log","post","find","c","_id","message","base","md","length","SCALE","map","notif","chat","filter","n","isGroupChat","chatName","users","name","pic","e","target","value"],"mappings":"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","sourcesContent":["import { Button } from \"@chakra-ui/button\";\r\nimport { useDisclosure } from \"@chakra-ui/hooks\";\r\nimport { Input } from \"@chakra-ui/input\";\r\nimport { Box, Text } from \"@chakra-ui/layout\";\r\nimport {\r\n  Menu,\r\n  MenuButton,\r\n  MenuDivider,\r\n  MenuItem,\r\n  MenuList,\r\n} from \"@chakra-ui/menu\";\r\nimport {\r\n  Drawer,\r\n  DrawerBody,\r\n  DrawerContent,\r\n  DrawerHeader,\r\n  DrawerOverlay,\r\n} from \"@chakra-ui/modal\";\r\nimport { Tooltip } from \"@chakra-ui/tooltip\";\r\nimport { BellIcon, ChevronDownIcon } from \"@chakra-ui/icons\";\r\nimport { Avatar } from \"@chakra-ui/avatar\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { useState } from \"react\";\r\nimport axios from \"axios\";\r\nimport { useToast } from \"@chakra-ui/toast\";\r\nimport ChatLoading from \"../ChatLoading\";\r\nimport { Spinner } from \"@chakra-ui/spinner\";\r\nimport ProfileModal from \"./ProfileModal\";\r\nimport NotificationBadge from \"react-notification-badge\";\r\nimport { Effect } from \"react-notification-badge\";\r\nimport { getSender } from \"../../config/ChatLogics\";\r\nimport UserListItem from \"../userAvatar/UserListItem\";\r\nimport { ChatState } from \"../../Context/ChatProvider\";\r\n\r\nfunction SideDrawer() {\r\n  const [search, setSearch] = useState(\"\");\r\n  const [searchResult, setSearchResult] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [loadingChat, setLoadingChat] = useState(false);\r\n\r\n  const {\r\n    setSelectedChat,\r\n    user,\r\n    notification,\r\n    setNotification,\r\n    chats,\r\n    setChats,\r\n  } = ChatState();\r\n\r\n  const toast = useToast();\r\n  const { isOpen, onOpen, onClose } = useDisclosure();\r\n  const history = useHistory();\r\n\r\n  const logoutHandler = () => {\r\n    localStorage.removeItem(\"userInfo\");\r\n    history.push(\"/\");\r\n  };\r\n\r\n  const handleSearch = async () => {\r\n    if (!search) {\r\n      toast({\r\n        title: \"Please Enter something in search\",\r\n        status: \"warning\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"top-left\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setLoading(true);\r\n\r\n      const config = {\r\n        headers: {\r\n          Authorization: `Bearer ${user.token}`,\r\n        },\r\n      };\r\n\r\n      const { data } = await axios.get(`/api/user?search=${search}`, config);\r\n\r\n      setLoading(false);\r\n      setSearchResult(data);\r\n    } catch (error) {\r\n      toast({\r\n        title: \"Error Occured!\",\r\n        description: \"Failed to Load the Search Results\",\r\n        status: \"error\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom-left\",\r\n      });\r\n    }\r\n  };\r\n\r\n  const accessChat = async (userId) => {\r\n    console.log(userId);\r\n\r\n    try {\r\n      setLoadingChat(true);\r\n      const config = {\r\n        headers: {\r\n          \"Content-type\": \"application/json\",\r\n          Authorization: `Bearer ${user.token}`,\r\n        },\r\n      };\r\n      const { data } = await axios.post(`/api/chat`, { userId }, config);\r\n\r\n      if (!chats.find((c) => c._id === data._id)) setChats([data, ...chats]);\r\n      setSelectedChat(data);\r\n      setLoadingChat(false);\r\n      onClose();\r\n    } catch (error) {\r\n      toast({\r\n        title: \"Error fetching the chat\",\r\n        description: error.message,\r\n        status: \"error\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom-left\",\r\n      });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Box\r\n        d=\"flex\"\r\n        justifyContent=\"space-between\"\r\n        alignItems=\"center\"\r\n        bg=\"white\"\r\n        w=\"100%\"\r\n        p=\"5px 10px 5px 10px\"\r\n        borderWidth=\"5px\"\r\n      >\r\n        <Tooltip label=\"Search Users to chat\" hasArrow placement=\"bottom-end\">\r\n          <Button variant=\"ghost\" onClick={onOpen}>\r\n            <i className=\"fas fa-search\"></i>\r\n            <Text d={{ base: \"none\", md: \"flex\" }} px={4}>\r\n              Search User\r\n            </Text>\r\n          </Button>\r\n        </Tooltip>\r\n        <Text fontSize=\"2xl\" fontFamily=\"Work sans\">\r\n          Chatters\r\n        </Text>\r\n        <div>\r\n          <Menu>\r\n            <MenuButton p={1}>\r\n              <NotificationBadge\r\n                count={notification.length}\r\n                effect={Effect.SCALE}\r\n              />\r\n              <BellIcon fontSize=\"2xl\" m={1} />\r\n            </MenuButton>\r\n            <MenuList pl={2}>\r\n              {!notification.length && \"No New Messages\"}\r\n              {notification.map((notif) => (\r\n                <MenuItem\r\n                  key={notif._id}\r\n                  onClick={() => {\r\n                    setSelectedChat(notif.chat);\r\n                    setNotification(notification.filter((n) => n !== notif));\r\n                  }}\r\n                >\r\n                  {notif.chat.isGroupChat\r\n                    ? `New Message in ${notif.chat.chatName}`\r\n                    : `New Message from ${getSender(user, notif.chat.users)}`}\r\n                </MenuItem>\r\n              ))}\r\n            </MenuList>\r\n          </Menu>\r\n          <Menu>\r\n            <MenuButton as={Button} bg=\"white\" rightIcon={<ChevronDownIcon />}>\r\n              <Avatar\r\n                size=\"sm\"\r\n                cursor=\"pointer\"\r\n                name={user.name}\r\n                src={user.pic}\r\n              />\r\n            </MenuButton>\r\n            <MenuList>\r\n              <ProfileModal user={user}>\r\n                <MenuItem>My Profile</MenuItem>{\" \"}\r\n              </ProfileModal>\r\n              <MenuDivider />\r\n              <MenuItem onClick={logoutHandler}>Logout</MenuItem>\r\n            </MenuList>\r\n          </Menu>\r\n        </div>\r\n      </Box>\r\n\r\n      <Drawer placement=\"left\" onClose={onClose} isOpen={isOpen}>\r\n        <DrawerOverlay />\r\n        <DrawerContent>\r\n          <DrawerHeader borderBottomWidth=\"1px\">Search Users</DrawerHeader>\r\n          <DrawerBody>\r\n            <Box d=\"flex\" pb={2}>\r\n              <Input\r\n                placeholder=\"Search by name or email\"\r\n                mr={2}\r\n                value={search}\r\n                onChange={(e) => setSearch(e.target.value)}\r\n              />\r\n              <Button onClick={handleSearch}>Go</Button>\r\n            </Box>\r\n            {loading ? (\r\n              <ChatLoading />\r\n            ) : (\r\n              searchResult?.map((user) => (\r\n                <UserListItem\r\n                  key={user._id}\r\n                  user={user}\r\n                  handleFunction={() => accessChat(user._id)}\r\n                />\r\n              ))\r\n            )}\r\n            {loadingChat && <Spinner ml=\"auto\" d=\"flex\" />}\r\n          </DrawerBody>\r\n        </DrawerContent>\r\n      </Drawer>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default SideDrawer;\r\n"]},"metadata":{},"sourceType":"module"}