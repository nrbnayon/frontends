{"ast":null,"code":"const Polling = require(\"./polling\");\nconst globalThis = require(\"../globalThis\");\nconst rNewline = /\\n/g;\nconst rEscapedNewline = /\\\\n/g;\n\n/**\r\n * Global JSONP callbacks.\r\n */\n\nlet callbacks;\nclass JSONPPolling extends Polling {\n  /**\r\n   * JSONP Polling constructor.\r\n   *\r\n   * @param {Object} opts.\r\n   * @api public\r\n   */\n  constructor(opts) {\n    super(opts);\n    this.query = this.query || {};\n\n    // define global callbacks array if not present\n    // we do this here (lazily) to avoid unneeded global pollution\n    if (!callbacks) {\n      // we need to consider multiple engines in the same page\n      callbacks = globalThis.___eio = globalThis.___eio || [];\n    }\n\n    // callback identifier\n    this.index = callbacks.length;\n\n    // add callback to jsonp global\n    callbacks.push(this.onData.bind(this));\n\n    // append to query string\n    this.query.j = this.index;\n  }\n\n  /**\r\n   * JSONP only supports binary as base64 encoded strings\r\n   */\n  get supportsBinary() {\n    return false;\n  }\n\n  /**\r\n   * Closes the socket.\r\n   *\r\n   * @api private\r\n   */\n  doClose() {\n    if (this.script) {\n      // prevent spurious errors from being emitted when the window is unloaded\n      this.script.onerror = () => {};\n      this.script.parentNode.removeChild(this.script);\n      this.script = null;\n    }\n    if (this.form) {\n      this.form.parentNode.removeChild(this.form);\n      this.form = null;\n      this.iframe = null;\n    }\n    super.doClose();\n  }\n\n  /**\r\n   * Starts a poll cycle.\r\n   *\r\n   * @api private\r\n   */\n  doPoll() {\n    const script = document.createElement(\"script\");\n    if (this.script) {\n      this.script.parentNode.removeChild(this.script);\n      this.script = null;\n    }\n    script.async = true;\n    script.src = this.uri();\n    script.onerror = e => {\n      this.onError(\"jsonp poll error\", e);\n    };\n    const insertAt = document.getElementsByTagName(\"script\")[0];\n    if (insertAt) {\n      insertAt.parentNode.insertBefore(script, insertAt);\n    } else {\n      (document.head || document.body).appendChild(script);\n    }\n    this.script = script;\n    const isUAgecko = \"undefined\" !== typeof navigator && /gecko/i.test(navigator.userAgent);\n    if (isUAgecko) {\n      setTimeout(function () {\n        const iframe = document.createElement(\"iframe\");\n        document.body.appendChild(iframe);\n        document.body.removeChild(iframe);\n      }, 100);\n    }\n  }\n\n  /**\r\n   * Writes with a hidden iframe.\r\n   *\r\n   * @param {String} data to send\r\n   * @param {Function} called upon flush.\r\n   * @api private\r\n   */\n  doWrite(data, fn) {\n    let iframe;\n    if (!this.form) {\n      const form = document.createElement(\"form\");\n      const area = document.createElement(\"textarea\");\n      const id = this.iframeId = \"eio_iframe_\" + this.index;\n      form.className = \"socketio\";\n      form.style.position = \"absolute\";\n      form.style.top = \"-1000px\";\n      form.style.left = \"-1000px\";\n      form.target = id;\n      form.method = \"POST\";\n      form.setAttribute(\"accept-charset\", \"utf-8\");\n      area.name = \"d\";\n      form.appendChild(area);\n      document.body.appendChild(form);\n      this.form = form;\n      this.area = area;\n    }\n    this.form.action = this.uri();\n    function complete() {\n      initIframe();\n      fn();\n    }\n    const initIframe = () => {\n      if (this.iframe) {\n        try {\n          this.form.removeChild(this.iframe);\n        } catch (e) {\n          this.onError(\"jsonp polling iframe removal error\", e);\n        }\n      }\n      try {\n        // ie6 dynamic iframes with target=\"\" support (thanks Chris Lambacher)\n        const html = '<iframe src=\"javascript:0\" name=\"' + this.iframeId + '\">';\n        iframe = document.createElement(html);\n      } catch (e) {\n        iframe = document.createElement(\"iframe\");\n        iframe.name = this.iframeId;\n        iframe.src = \"javascript:0\";\n      }\n      iframe.id = this.iframeId;\n      this.form.appendChild(iframe);\n      this.iframe = iframe;\n    };\n    initIframe();\n\n    // escape \\n to prevent it from being converted into \\r\\n by some UAs\n    // double escaping is required for escaped new lines because unescaping of new lines can be done safely on server-side\n    data = data.replace(rEscapedNewline, \"\\\\\\n\");\n    this.area.value = data.replace(rNewline, \"\\\\n\");\n    try {\n      this.form.submit();\n    } catch (e) {}\n    if (this.iframe.attachEvent) {\n      this.iframe.onreadystatechange = () => {\n        if (this.iframe.readyState === \"complete\") {\n          complete();\n        }\n      };\n    } else {\n      this.iframe.onload = complete;\n    }\n  }\n}\nmodule.exports = JSONPPolling;","map":{"version":3,"names":["Polling","require","globalThis","rNewline","rEscapedNewline","callbacks","JSONPPolling","constructor","opts","query","___eio","index","length","push","onData","bind","j","supportsBinary","doClose","script","onerror","parentNode","removeChild","form","iframe","doPoll","document","createElement","async","src","uri","e","onError","insertAt","getElementsByTagName","insertBefore","head","body","appendChild","isUAgecko","navigator","test","userAgent","setTimeout","doWrite","data","fn","area","id","iframeId","className","style","position","top","left","target","method","setAttribute","name","action","complete","initIframe","html","replace","value","submit","attachEvent","onreadystatechange","readyState","onload","module","exports"],"sources":["E:/Hasan sir project/4/frontend/node_modules/engine.io-client/lib/transports/polling-jsonp.js"],"sourcesContent":["const Polling = require(\"./polling\");\r\nconst globalThis = require(\"../globalThis\");\r\n\r\nconst rNewline = /\\n/g;\r\nconst rEscapedNewline = /\\\\n/g;\r\n\r\n/**\r\n * Global JSONP callbacks.\r\n */\r\n\r\nlet callbacks;\r\n\r\nclass JSONPPolling extends Polling {\r\n  /**\r\n   * JSONP Polling constructor.\r\n   *\r\n   * @param {Object} opts.\r\n   * @api public\r\n   */\r\n  constructor(opts) {\r\n    super(opts);\r\n\r\n    this.query = this.query || {};\r\n\r\n    // define global callbacks array if not present\r\n    // we do this here (lazily) to avoid unneeded global pollution\r\n    if (!callbacks) {\r\n      // we need to consider multiple engines in the same page\r\n      callbacks = globalThis.___eio = globalThis.___eio || [];\r\n    }\r\n\r\n    // callback identifier\r\n    this.index = callbacks.length;\r\n\r\n    // add callback to jsonp global\r\n    callbacks.push(this.onData.bind(this));\r\n\r\n    // append to query string\r\n    this.query.j = this.index;\r\n  }\r\n\r\n  /**\r\n   * JSONP only supports binary as base64 encoded strings\r\n   */\r\n  get supportsBinary() {\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Closes the socket.\r\n   *\r\n   * @api private\r\n   */\r\n  doClose() {\r\n    if (this.script) {\r\n      // prevent spurious errors from being emitted when the window is unloaded\r\n      this.script.onerror = () => {};\r\n      this.script.parentNode.removeChild(this.script);\r\n      this.script = null;\r\n    }\r\n\r\n    if (this.form) {\r\n      this.form.parentNode.removeChild(this.form);\r\n      this.form = null;\r\n      this.iframe = null;\r\n    }\r\n\r\n    super.doClose();\r\n  }\r\n\r\n  /**\r\n   * Starts a poll cycle.\r\n   *\r\n   * @api private\r\n   */\r\n  doPoll() {\r\n    const script = document.createElement(\"script\");\r\n\r\n    if (this.script) {\r\n      this.script.parentNode.removeChild(this.script);\r\n      this.script = null;\r\n    }\r\n\r\n    script.async = true;\r\n    script.src = this.uri();\r\n    script.onerror = e => {\r\n      this.onError(\"jsonp poll error\", e);\r\n    };\r\n\r\n    const insertAt = document.getElementsByTagName(\"script\")[0];\r\n    if (insertAt) {\r\n      insertAt.parentNode.insertBefore(script, insertAt);\r\n    } else {\r\n      (document.head || document.body).appendChild(script);\r\n    }\r\n    this.script = script;\r\n\r\n    const isUAgecko =\r\n      \"undefined\" !== typeof navigator && /gecko/i.test(navigator.userAgent);\r\n\r\n    if (isUAgecko) {\r\n      setTimeout(function() {\r\n        const iframe = document.createElement(\"iframe\");\r\n        document.body.appendChild(iframe);\r\n        document.body.removeChild(iframe);\r\n      }, 100);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Writes with a hidden iframe.\r\n   *\r\n   * @param {String} data to send\r\n   * @param {Function} called upon flush.\r\n   * @api private\r\n   */\r\n  doWrite(data, fn) {\r\n    let iframe;\r\n\r\n    if (!this.form) {\r\n      const form = document.createElement(\"form\");\r\n      const area = document.createElement(\"textarea\");\r\n      const id = (this.iframeId = \"eio_iframe_\" + this.index);\r\n\r\n      form.className = \"socketio\";\r\n      form.style.position = \"absolute\";\r\n      form.style.top = \"-1000px\";\r\n      form.style.left = \"-1000px\";\r\n      form.target = id;\r\n      form.method = \"POST\";\r\n      form.setAttribute(\"accept-charset\", \"utf-8\");\r\n      area.name = \"d\";\r\n      form.appendChild(area);\r\n      document.body.appendChild(form);\r\n\r\n      this.form = form;\r\n      this.area = area;\r\n    }\r\n\r\n    this.form.action = this.uri();\r\n\r\n    function complete() {\r\n      initIframe();\r\n      fn();\r\n    }\r\n\r\n    const initIframe = () => {\r\n      if (this.iframe) {\r\n        try {\r\n          this.form.removeChild(this.iframe);\r\n        } catch (e) {\r\n          this.onError(\"jsonp polling iframe removal error\", e);\r\n        }\r\n      }\r\n\r\n      try {\r\n        // ie6 dynamic iframes with target=\"\" support (thanks Chris Lambacher)\r\n        const html = '<iframe src=\"javascript:0\" name=\"' + this.iframeId + '\">';\r\n        iframe = document.createElement(html);\r\n      } catch (e) {\r\n        iframe = document.createElement(\"iframe\");\r\n        iframe.name = this.iframeId;\r\n        iframe.src = \"javascript:0\";\r\n      }\r\n\r\n      iframe.id = this.iframeId;\r\n\r\n      this.form.appendChild(iframe);\r\n      this.iframe = iframe;\r\n    };\r\n\r\n    initIframe();\r\n\r\n    // escape \\n to prevent it from being converted into \\r\\n by some UAs\r\n    // double escaping is required for escaped new lines because unescaping of new lines can be done safely on server-side\r\n    data = data.replace(rEscapedNewline, \"\\\\\\n\");\r\n    this.area.value = data.replace(rNewline, \"\\\\n\");\r\n\r\n    try {\r\n      this.form.submit();\r\n    } catch (e) {}\r\n\r\n    if (this.iframe.attachEvent) {\r\n      this.iframe.onreadystatechange = () => {\r\n        if (this.iframe.readyState === \"complete\") {\r\n          complete();\r\n        }\r\n      };\r\n    } else {\r\n      this.iframe.onload = complete;\r\n    }\r\n  }\r\n}\r\n\r\nmodule.exports = JSONPPolling;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}